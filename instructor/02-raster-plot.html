<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Introduction to Geospatial Raster and Vector Data with R for COBALT: Plot Raster Data</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg"></div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../02-raster-plot.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Introduction to Geospatial Raster and Vector Data with R for COBALT
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Introduction to Geospatial Raster and Vector Data with R for COBALT
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html"></a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to Geospatial Raster and Vector Data with R for COBALT
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 9%" class="percentage">
    9%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 9%" aria-valuenow="9" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../02-raster-plot.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-raster-structure.html">1. Intro to Raster Data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        2. Plot Raster Data
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#plot-raster-data-in-r">Plot Raster Data in R</a></li>
<li><a href="#plotting-data-using-breaks">Plotting Data Using Breaks</a></li>
<li><a href="#interactive-maps">Interactive Maps</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="06-vector-open-shapefile-in-r.html">3. Open and Plot Vector Layers</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="07-vector-shapefile-attributes-in-r.html">4. Explore and Plot by Vector Layer Attributes</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="08-vector-plot-shapefiles-custom-legend.html">5. Plot Multiple Vector Layers</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="09-vector-when-data-dont-line-up-crs.html">6. Handling Spatial Projection &amp; CRS</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="10-vector-csv-to-shapefile-in-r.html">7. Convert from .csv to a Vector Layer</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="11-vector-raster-integration.html">8. Extracting Data from Rasters using Vectors</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="05-raster-multi-band-in-r.html">9. Work with Multi-Band Rasters</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="04-raster-calculations-in-r.html">10. Raster Calculations</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html"></a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/01-raster-structure.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-vector-open-shapefile-in-r.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/01-raster-structure.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Intro to Raster Data
        </a>
        <a class="chapter-link float-end" href="../instructor/06-vector-open-shapefile-in-r.html" rel="next">
          Next: Open and Plot Vector... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Plot Raster Data</h1>
        <p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/cobalt-casco/r-raster-vector-geospatial/edit/main/episodes/02-raster-plot.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 70 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in
download.file("https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/physical/ne_110m_graticules_all.zip",
: cannot open URL
'https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/physical/ne_110m_graticules_all.zip':
HTTP status was '500 Internal Server Error'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in download.file("https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/physical/ne_110m_graticules_all.zip", : cannot open URL 'https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/physical/ne_110m_graticules_all.zip'</code></pre>
</div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can I create categorized or customized maps of raster data?</li>
<li>How can I customize the color scheme of a raster image?</li>
<li>How can I make my visualizations interactive?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Build customized plots for a single band raster using the
<code>ggplot2</code> package.</li>
<li>Make interactive maps with leaflet</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>First, let’s load some libraries. You should have them loaded from
the previous less, but in case you don’t -</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">terra</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyterra</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<p>We are also going to load one new library.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">leaflet</span><span class="op">)</span></span></code></pre>
</div>
<p>To remind you, this is the data we will be using -</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Learners will have this data loaded from earlier episode</span></span>
<span><span class="co"># DSM data for Harvard Forest</span></span>
<span><span class="va">b10_casco_2023</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">rast</span><span class="op">(</span><span class="st">"data/landsat_casco/b10_cropped/LC09_L2SP_011030_20230920_20230922_02_T1_ST_B10.TIF"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">clamp</span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">50</span>,</span>
<span>        upper <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b10_casco_2023_df</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="va">b10_casco_2023</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div id="things-youll-need-to-complete-this-episode" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="things-youll-need-to-complete-this-episode" class="callout-inner">
<h3 class="callout-title">Things You’ll Need To Complete This
Episode<a class="anchor" aria-label="anchor" href="#things-youll-need-to-complete-this-episode"></a>
</h3>
<div class="callout-content">
<p>See the <a href=".">lesson homepage</a> for detailed information
about the software, data, and other prerequisites you will need to work
through the examples in this episode.</p>
</div>
</div>
</div>
<section id="plot-raster-data-in-r"><h2 class="section-heading">Plot Raster Data in R<a class="anchor" aria-label="anchor" href="#plot-raster-data-in-r"></a>
</h2>
<hr class="half-width"><p>This episode covers how to plot a raster in R using the
<code>ggplot2</code> package with customized coloring schemes. We will
then make interactive maps with <code>leaflet</code>.</p>
<p>We will continue working with the Landsat SST data from Casco
Bay.</p>
</section><section id="plotting-data-using-breaks"><h2 class="section-heading">Plotting Data Using Breaks<a class="anchor" aria-label="anchor" href="#plotting-data-using-breaks"></a>
</h2>
<hr class="half-width"><p>In the previous episode, we viewed our data using a continuous color
ramp. For clarity and visibility of the plot - or if there are classes
you are interested in - we may prefer to view the data “symbolized” or
colored according to ranges of values. This is comparable to a
“classified” map. To do this, we need to tell <code>ggplot</code> how
many groups to break our data into, and where those breaks should be. To
make these decisions, it is useful to first explore the distribution of
the data using a bar plot. To begin with, we will use
<code>dplyr</code>’s <code>mutate()</code> function combined with
<code>cut()</code> to split the data into 4 bins.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b10_casco_2023_df</span> <span class="op">&lt;-</span> <span class="va">b10_casco_2023_df</span> <span class="op">%&gt;%</span></span>
<span>                <span class="fu">mutate</span><span class="op">(</span>fct_sst <span class="op">=</span> <span class="fu">cut</span><span class="op">(</span><span class="va">SST_F_20230920</span>, breaks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2023_df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">fct_sst</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-histogram-breaks-ggplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>If we want to know the cutoff values for the groups, we can ask for
the unique values of <code>fct_sst</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">unique</span><span class="op">(</span><span class="va">b10_casco_2023_df</span><span class="op">$</span><span class="va">fct_sst</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] (62.5,68.8] (68.8,75]   (56.2,62.5] (50,56.2]  
Levels: (50,56.2] (56.2,62.5] (62.5,68.8] (68.8,75]</code></pre>
</div>
<p>And we can get the count of values in each group using
<code>dplyr</code>’s <code>group_by()</code> and <code>count()</code>
functions:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b10_casco_2023_df</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">group_by</span><span class="op">(</span><span class="va">fct_sst</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">count</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 4 × 2
# Groups:   fct_sst [4]
  fct_sst          n
  &lt;fct&gt;        &lt;int&gt;
1 (50,56.2]     2370
2 (56.2,62.5] 657710
3 (62.5,68.8]  92571
4 (68.8,75]     2461</code></pre>
</div>
<p>We might prefer to customize the cutoff values for these groups. Lets
round the cutoff values so that we have groups for the ranges of 50 –
55F, 55 – 60F, 65 - 70F and 70-75F. To implement this we will give
<code>mutate()</code> a numeric vector of break points instead of the
number of breaks we want.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_bins</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">55</span>, <span class="fl">60</span>, <span class="fl">65</span>, <span class="fl">70</span>, <span class="fl">75</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b10_casco_2023_df</span> <span class="op">&lt;-</span> <span class="va">b10_casco_2023_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>fct_sst_2 <span class="op">=</span> <span class="fu">cut</span><span class="op">(</span><span class="va">SST_F_20230920</span>, breaks <span class="op">=</span> <span class="va">custom_bins</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">unique</span><span class="op">(</span><span class="va">b10_casco_2023_df</span><span class="op">$</span><span class="va">fct_sst_2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] (65,70] (70,75] (60,65] (55,60] (50,55] &lt;NA&gt;   
Levels: (50,55] (55,60] (60,65] (65,70] (70,75]</code></pre>
</div>
<p><code>cut()</code> is a powerful function, and there are a series of
related ones that are quite useful.</p>
<table class="table"><colgroup><col width="53%"><col width="46%"></colgroup><thead><tr class="header"><th>function</th>
<th>what it does</th>
</tr></thead><tbody><tr class="odd"><td>cut</td>
<td>makes groups based on pre-defined breakpoints</td>
</tr><tr class="even"><td>cut_interval</td>
<td>makes n groups with equal range</td>
</tr><tr class="odd"><td>cut_width</td>
<td>makes groups with a given width</td>
</tr><tr class="even"><td>cut_number</td>
<td>makes n groups with an equal number of observations</td>
</tr></tbody></table><p>Try them out with <code>b10_casco_2023_df$SST_F_20230920</code> to
see how they differ.</p>
<div id="data-tips" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="data-tips" class="callout-inner">
<h3 class="callout-title">Data Tips<a class="anchor" aria-label="anchor" href="#data-tips"></a>
</h3>
<div class="callout-content">
<p>Note that when we assign break values a set of 6 values will result
in 5 bins of data.</p>
<p>The bin intervals are shown using <code>(</code> to mean exclusive
and <code>]</code> to mean inclusive. For example: <code>(65, 70]</code>
means “from 65 through 70”.</p>
</div>
</div>
</div>
<p>And now we can plot our bar plot again, using the new groups:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2023_df</span>, </span>
<span>           mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span><span class="va">fct_sst_2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-histogram-custom-breaks-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>And we can get the count of values in each group in the same way we
did before:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b10_casco_2023_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">fct_sst_2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 × 2
# Groups:   fct_sst_2 [6]
  fct_sst_2      n
  &lt;fct&gt;      &lt;int&gt;
1 (50,55]     1483
2 (55,60]   176310
3 (60,65]   562050
4 (65,70]    13284
5 (70,75]     1715
6 &lt;NA&gt;         270</code></pre>
</div>
<p>We can use those groups to plot our raster data, with each group
being a different color. We could do this with our data frame, or, we
can use the <code>scale_color_binned()</code> color scale. This is a
feature of <code>ggplot2</code> that lets you create bins on the fly and
plot them. We can specify our custom breaks with the <code>breaks</code>
argument.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spatraster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2023</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_binned</span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">custom_bins</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-raster-with-breaks-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>A lot of color scales have binned versions. We could have done the
above with <code>scale_fill_viridis_b()</code>. Or we could place with
<code>scale_fill_fermenter()</code> which comes from <a href="https://colorbrewer2.org/" class="external-link">Color Brewer</a>.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spatraster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2023</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_fermenter</span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">custom_bins</span>,</span>
<span>                       palette <span class="op">=</span> <span class="st">"Accent"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-raster-with-breaks-fermenter-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note the choices of palette. ColorBrewer supplies quite a few to
try!</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu">display.brewer.all</span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-show-brewer-pal-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is just the tip of the iceberg when looking for color palettes
for R, and it’s a topic well worth searching out when you want to
customize your own plots to the nth degree. You can even make your own
custom palette with <code>scale_fill_stepsn()</code>.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_pal</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spatraster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2023</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_stepsn</span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">custom_bins</span>,,</span>
<span>                    colors <span class="op">=</span> <span class="va">my_pal</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-binned_scale_manual-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>One advantage to this is that you can then use the same breaks and
color palette across multiple plots for consistency, rather than having
<code>ggplot2</code> choose the breaks and palette stretching for you.
There are also many wonderful palette packages, like <a href="https://github.com/karthik/wesanderson" class="external-link">wesanderson</a> or <a href="https://github.com/dill/beyonce" class="external-link">beyonce</a>.</p>
<div class="section level3">
<h3 id="more-plot-formatting">More Plot Formatting<a class="anchor" aria-label="anchor" href="#more-plot-formatting"></a></h3>
<p>All labels in a plot can be controlled by the <code>labs()</code>
function. So, if we wanted to give the fill name “SST (F)”, label the X
and Y axis, and give this plot a title of “SST on Sept 9, 2023” we can
do so easily.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spatraster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2023</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_stepsn</span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">custom_bins</span>,,</span>
<span>                    colors <span class="op">=</span> <span class="va">my_pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"SST on Sept 9, 2023"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"SST (F)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-add-ggplot-labels-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can also retheme the entire plot - changing the background, axis
options, and more. If you really want to get deeply into themes, there
are many wonderful packages out there like <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" class="external-link">ggthemes</a>,
<a href="https://ryo-n7.github.io/tvthemes/" class="external-link">tvthemes</a>, <a href="https://cinc.rud.is/web/packages/hrbrthemes/" class="external-link">hrbrthemes</a>, <a href="https://nanx.me/ggsci/" class="external-link">ggsci</a>, and so many more.</p>
<p>Within ggplot itself, chekc out the different <code>theme_*()</code>
functions, such as <code>theme_void()</code>. We can use the
<code>base_size</code> argument to specify a base font size as well.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spatraster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2023</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_stepsn</span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">custom_bins</span>,,</span>
<span>                    colors <span class="op">=</span> <span class="va">my_pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"SST on Sept 9, 2023"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"SST (F)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_void</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-turn-off-axes-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>You can also make your own custom theme or theme modifications with
the <code>theme()</code> function. Dig into the <code>?theme</code>
helpfile to learn more and see examples.</p>
<div id="challenge-plot-using-custom-breaks" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-plot-using-custom-breaks" class="callout-inner">
<h3 class="callout-title">Challenge: Plot Using Custom Breaks<a class="anchor" aria-label="anchor" href="#challenge-plot-using-custom-breaks"></a>
</h3>
<div class="callout-content">
<p>Create a plot of the Casco Bay SST in August 2013 that has:</p>
<ol style="list-style-type: decimal"><li>Three classified ranges of values (break points) that are evenly
divided among the range of pixel values. Any palette you’d like!</li>
<li>Axis labels.</li>
<li>A plot title.</li>
<li>A unique theme.</li>
</ol><p>The file is
<code>data/landsat_casco/b10_cropped/LC08_L2SP_011030_20130815_20200912_02_T1_ST_B10.TIF</code>
to remind you.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Answers</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b10_casco_2013</span> <span class="op">&lt;-</span> <span class="fu">rast</span><span class="op">(</span><span class="st">"data/landsat_casco/b10_cropped/LC08_L2SP_011030_20130815_20200912_02_T1_ST_B10.TIF"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># find intervals</span></span>
<span><span class="fu">cut_interval</span><span class="op">(</span><span class="fu">values</span><span class="op">(</span><span class="va">b10_casco_2013</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">levels</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># round those intervals into breaks</span></span>
<span><span class="va">new_breaks</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">65</span>, <span class="fl">75</span>, <span class="fl">85</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot with these new breaks using Set2 as the palette</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spatraster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">b10_casco_2013</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_fermenter</span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">new_breaks</span>,</span>
<span>                    palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"SST on Aug 15, 2023"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"SST (F)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu">theme_few</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="interactive-maps"><h2 class="section-heading">Interactive Maps<a class="anchor" aria-label="anchor" href="#interactive-maps"></a>
</h2>
<hr class="half-width"><p>These static maps are beautiful, but, they can be difficult if you
notice features occurring at small scales you want to investigate.
They’re also wonderful objects to build for web applications and the
like, as they allow users a degree of interactivity.</p>
<p>For a basic level of interactivity - just to explore -
<code>terra</code> includes a function called <code>plet()</code> which
lets us look at our raster interactively.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plet</span><span class="op">(</span><span class="va">b10_casco_2023</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-plet-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is great, and we can even put some reference behind it with the
<code>tiles</code> argument.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plet</span><span class="op">(</span><span class="va">b10_casco_2023</span>, tile <span class="op">=</span> <span class="st">"Esri.WorldImagery"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-plet-tiles-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>What do you learn from this?</p>
<div id="challenge" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge" class="callout-inner">
<h3 class="callout-title">Challenge:<a class="anchor" aria-label="anchor" href="#challenge"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li><p>What does 2013 look like by comparison? Are spatial patterns the
same, or different?</p></li>
<li><p>There are many <code>tiles</code> options. Try “Streets” and
“OpenTopoMap”. Which do you prefer and why?</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Answers</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plet</span><span class="op">(</span><span class="va">b10_casco_2023</span>, tile <span class="op">=</span> <span class="st">"Street"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="data-tips-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="data-tips-1" class="callout-inner">
<h3 class="callout-title">Data Tips<a class="anchor" aria-label="anchor" href="#data-tips-1"></a>
</h3>
<div class="callout-content">
<p>If you want to make sure things can be seen behind the raster, try
fiddling with the <code>alpha</code> values. It’s set to 0.8 by default
The alpha value determines how transparent the colors will be (0 being
transparent, 1 being opaque).</p>
<p>There are other options for <code>plet</code> that could be well
worth an exploration as you use it to try and understand what is
happening in your raster imagery.</p>
</div>
</div>
</div>
<p>The above is well and good for exploration, but for presentation you
might something more customized. Did you notice in the lowe right-hand
corner the word “leaflet”? This is the name of a Javascript library that
powers a lot of interactive maps you see on the internet.
<code>plet()</code> actually calls an R library <code>leaflet</code>
that then interacts with the Javascript library to make these maps. You
can learn a lot more about <code>leaflet</code> for R from <a href="https://rstudio.github.io/leaflet/" class="external-link">here</a>.</p>
<p>The <code>leaflet</code> library works in some very similar and some
very different ways from <code>ggplot2</code>. It’s useful to know as it
allows us to customize the presentation of our maps for a public
audience. It works by building a map up in a sequence of layers, like
<code>ggplot2</code>, except that it uses the pipe to add each new
element. For example, to generate the above map, we’d have to first
initialize a <code>leaflet()</code> map, then <code>addTiles()</code>,
and finally <code>addRasterImage()</code>.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">leaflet</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addTiles</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addRasterImage</span><span class="op">(</span><span class="va">b10_casco_2023</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-leaflet-basic-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that the color palette is different as is the background map
from <code>plet()</code>. This is all customizable!</p>
<p><code>addTiles()</code> takes an argument <code>urlTemplate</code>
which looks a bit odd, but, you can get the arguments for different
tilesets from <a href="https://leaflet-extras.github.io/leaflet-providers/preview/index.html" class="external-link">this
site</a>. Or use <code>addProviderTiles()</code> to just specify a
provider and map.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addProviderTiles</span><span class="op">(</span><span class="st">"Esri.WorldImagery"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addRasterImage</span><span class="op">(</span><span class="va">b10_casco_2023</span>, opacity <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-show-leaflet-tiles-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>For colors, we can specify a color mapping - from our raster to a
palette. There are four functions for this. <code>colorNumeric()</code>
is for continuous values. <code>colorBin()</code> does what we’ve been
doing with <code>scale_fill_binned()</code>. We can use discrete values
with <code>colorFactor()</code> or if we want to use quantiles (e.g., to
highlight 95th percentiles and extremes beyond them), we can use
<code>colorQuantile()</code>. Each takes a palette, which we can either
specify as a vector of colors or a name of a ColorBrewer or Viridis
palette. It also takes a domain, the values the palette will be mapped
to.</p>
<p>What’s great about defining a palette here is that we can then use it
for <code>addLegend()</code> or for other maps to have equivalent
scales. Here’s an example using the <code>RdYlBu</code> palette. Don’t
forget to set <code>na.color = "transparent"</code> if you don’t want to
see it.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># note, using reverse = TRUE here as otherwise warm = blue</span></span>
<span><span class="va">my_pal</span> <span class="op">&lt;-</span> <span class="fu">colorNumeric</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlBu"</span>,</span>
<span>                    domain <span class="op">=</span> <span class="fu">values</span><span class="op">(</span><span class="va">b10_casco_2023</span><span class="op">)</span>,</span>
<span>                    na.color <span class="op">=</span> <span class="st">"transparent"</span>,</span>
<span>                    reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addTiles</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addRasterImage</span><span class="op">(</span><span class="va">b10_casco_2023</span>,</span>
<span>                 colors <span class="op">=</span> <span class="va">my_pal</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addLegend</span><span class="op">(</span>pal <span class="op">=</span> <span class="va">my_pal</span>, </span>
<span>            values <span class="op">=</span> <span class="fu">values</span><span class="op">(</span><span class="va">b10_casco_2023</span><span class="op">)</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"SST (F)"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/02-raster-plot-rendered-show-leaflet-colors-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge:<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Put together a leaflet map of 2013.</li>
<li>Add a tileset that you like.</li>
<li>Add colors to make it pop!</li>
<li>Look at the arguments for <code>addLegend()</code> to move it where
you want. If you’d like to go big, check out <code>addMiniMap()</code>,
<code>addScaleBar()</code>, or <code>addLayersControl()</code> with
multiple tile sets</li>
</ol></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Answers</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Let's do bins!</span></span>
<span><span class="va">new_pal</span> <span class="op">&lt;-</span> <span class="fu">colorBin</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"plasma"</span>,</span>
<span>                    domain <span class="op">=</span> <span class="fu">values</span><span class="op">(</span><span class="va">b10_casco_2013</span><span class="op">)</span>,</span>
<span>                    na.color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addProviderTiles</span><span class="op">(</span><span class="st">"Esri.WorldTerrain"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addProviderTiles</span><span class="op">(</span><span class="st">"Thunderforest.SpinalMap"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addProviderTiles</span><span class="op">(</span><span class="st">"Esri.WorldImagery"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addRasterImage</span><span class="op">(</span><span class="va">b10_casco_2013</span>,</span>
<span>                 colors <span class="op">=</span> <span class="va">new_pal</span>,</span>
<span>                 opacity <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addLegend</span><span class="op">(</span>pal <span class="op">=</span> <span class="va">new_pal</span>, </span>
<span>            values <span class="op">=</span> <span class="fu">values</span><span class="op">(</span><span class="va">b10_casco_2013</span><span class="op">)</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"SST (F)"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addScaleBar</span><span class="op">(</span><span class="st">"bottomleft"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">addLayersControl</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"bottomright"</span>,</span>
<span>                   baseGroups <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"World Terrain"</span>, </span>
<span>                                  <span class="st">"This Is Spinal Map!"</span>,</span>
<span>                                  <span class="st">"World Imagery"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Continuous data ranges can be grouped into categories using
<code>mutate()</code> and <code>cut()</code> or with a binned color
scale in <code>ggplot2</code>.</li>
<li>Use built-in color palettes with <code>scale_fill_viridis_b</code>
or <code>scale_fill_fermenter()</code> or set your preferred color
scheme manually.</li>
<li>Interactive plotting with <code>plet()</code> and the
<code>leaflet</code> library can lead to even better insights as you
zoom in and out.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/01-raster-structure.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-vector-open-shapefile-in-r.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/01-raster-structure.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Intro to Raster Data
        </a>
        <a class="chapter-link float-end" href="../instructor/06-vector-open-shapefile-in-r.html" rel="next">
          Next: Open and Plot Vector... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/cobalt-casco/r-raster-vector-geospatial/edit/main/episodes/02-raster-plot.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/cobalt-casco/r-raster-vector-geospatial/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/cobalt-casco/r-raster-vector-geospatial/" class="external-link">Source</a></p>
				<p><a href="https://github.com/cobalt-casco/r-raster-vector-geospatial/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:jarrett.byrnes@umb.edu">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://cobalt-casco.github.io/r-raster-vector-geospatial/instructor/02-raster-plot.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, Casco Bay, seagrass",
  "name": "Plot Raster Data",
  "creativeWorkStatus": "active",
  "url": "https://cobalt-casco.github.io/r-raster-vector-geospatial/instructor/02-raster-plot.html",
  "identifier": "https://cobalt-casco.github.io/r-raster-vector-geospatial/instructor/02-raster-plot.html",
  "dateCreated": "2023-11-05",
  "dateModified": "2024-03-12",
  "datePublished": "2024-04-23"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

